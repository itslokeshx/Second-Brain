<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Second Brain</title>
    <link href="main.css" rel="stylesheet">
</head>

<body>
    <!-- ═══════════════════════════════════════════════════════════════════ -->
    <!-- 🎨 BEAUTIFUL MINIMAL LOADING SCREEN -->
    <!-- ═══════════════════════════════════════════════════════════════════ -->
    <div id="app-loader" style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 999999;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    ">
        <div style="text-align: center;">
            <!-- Animated Tomato Icon -->
            <div style="
                width: 80px;
                height: 80px;
                margin: 0 auto 30px;
                position: relative;
                animation: float 3s ease-in-out infinite;
            ">
                <svg viewBox="0 0 100 100" style="width: 100%; height: 100%;">
                    <!-- Tomato body -->
                    <circle cx="50" cy="55" r="35" fill="#FF6B6B" style="
                        animation: pulse 2s ease-in-out infinite;
                    "/>
                    <!-- Leaf -->
                    <path d="M 50 20 Q 45 25, 50 30 Q 55 25, 50 20" fill="#4ECDC4" style="
                        animation: leaf 2s ease-in-out infinite;
                    "/>
                    <!-- Shine -->
                    <circle cx="40" cy="45" r="8" fill="rgba(255,255,255,0.3)"/>
                </svg>
            </div>

            <!-- App Name -->
            <h2 style="
                color: white;
                font-size: 28px;
                font-weight: 600;
                margin: 0 0 10px 0;
                letter-spacing: -0.5px;
            ">Second Brain</h2>

            <!-- Loading Text -->
            <p style="
                color: rgba(255,255,255,0.8);
                font-size: 14px;
                margin: 0 0 25px 0;
                font-weight: 400;
            ">Loading your workspace<span class="dots"></span></p>

            <!-- Progress Bar -->
            <div style="
                width: 200px;
                height: 3px;
                background: rgba(255,255,255,0.2);
                border-radius: 10px;
                overflow: hidden;
                margin: 0 auto;
            ">
                <div style="
                    width: 0%;
                    height: 100%;
                    background: linear-gradient(90deg, #4ECDC4, #44A08D);
                    border-radius: 10px;
                    animation: progress 2s ease-in-out infinite;
                "></div>
            </div>
        </div>
    </div>

    <style>
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes leaf {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(5deg); }
        }

        @keyframes progress {
            0% { width: 0%; margin-left: 0%; }
            50% { width: 70%; margin-left: 0%; }
            100% { width: 0%; margin-left: 100%; }
        }

        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }

        .dots::after {
            content: '';
            animation: dots 1.5s steps(4, end) infinite;
        }
    </style>

    <script>
        // Hide loader when React mounts or after max 30 seconds
        let loaderHidden = false;
        
        window.hideAppLoader = function() {
            if (loaderHidden) return;
            loaderHidden = true;
            
            console.log('[Loader] 🎨 Hiding loader...');
            const loader = document.getElementById('app-loader');
            if (loader) {
                loader.style.opacity = '0';
                loader.style.transition = 'opacity 0.5s ease';
                setTimeout(() => {
                    loader.style.display = 'none';
                    console.log('[Loader] ✅ Loader hidden');
                }, 500);
            }
        };

        // Method 1: Watch for React rendering to #root
        const observer = new MutationObserver(() => {
            const root = document.getElementById('root');
            if (root && root.children.length > 0) {
                console.log('[Loader] Detected React render in #root');
                setTimeout(window.hideAppLoader, 1000);
                observer.disconnect();
            }
        });

        const rootElement = document.getElementById('root');
        if (rootElement) {
            observer.observe(rootElement, { childList: true, subtree: true });
        }

        // Method 2: Watch for ANY visible content in body
        const bodyObserver = new MutationObserver(() => {
            // Check if there's visible content (not just scripts)
            const visibleElements = Array.from(document.body.children).filter(el => {
                return el.id !== 'app-loader' && 
                       el.tagName !== 'SCRIPT' && 
                       el.offsetHeight > 0;
            });
            
            if (visibleElements.length > 0) {
                console.log('[Loader] Detected visible content in body');
                setTimeout(window.hideAppLoader, 1000);
                bodyObserver.disconnect();
            }
        });
        
        bodyObserver.observe(document.body, { childList: true, subtree: true });

        // Method 3: Check for React app class or data attributes
        const checkInterval = setInterval(() => {
            const hasReactApp = document.querySelector('[data-reactroot]') || 
                               document.querySelector('.App') ||
                               document.querySelector('[class*="App"]');
            
            if (hasReactApp) {
                console.log('[Loader] Detected React app element');
                setTimeout(window.hideAppLoader, 1000);
                clearInterval(checkInterval);
            }
        }, 500);

        // Method 4: Fallback - hide after 25 seconds max
        setTimeout(() => {
            console.log('[Loader] Timeout reached - hiding loader');
            window.hideAppLoader();
            clearInterval(checkInterval);
        }, 25000);

        // Method 5: Hide on window load as final backup
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('[Loader] Window loaded - hiding loader');
                window.hideAppLoader();
            }, 3000);
        });
    </script>
    <div id="root" style="height: 100%; width: 100%;"></div>
    <div id="modal-root"></div>

    <div id="modal-root"></div>

    <!-- Fallback Sync Button (Visible if main UI fails) -->
    <div id="fallback-sync-btn" class="sync-button"
        style="position: fixed; bottom: 20px; right: 20px; z-index: 9999; background: #333; color: white; padding: 10px; border-radius: 5px; cursor: pointer; display: none;">
        🔄 Sync
    </div>

    <!-- ✅ URL INTERCEPTOR: Must load FIRST to redirect localhost→Render -->
    <script src="js/url-interceptor.js"></script>

    <!-- Hidden Elements to prevent auth-ui.js crash -->
    <div style="display: none;">
        <span id="username-display"></span>
        <button id="auth-btn">Login / Sync</button>
        <div id="auth-modal">
            <div id="login-form">
                <input id="login-email"><input id="login-password"><button id="btn-login"></button>
                <p id="login-error"></p>
                <div id="show-register"></div>
            </div>
            <div id="register-form">
                <input id="reg-username"><input id="reg-email"><input id="reg-password"><button
                    id="btn-register"></button>
                <p id="reg-error"></p>
                <div id="show-login"></div>
            </div>
            <span class="close-modal"></span>
        </div>
    </div>

    <div>
        <div id="task-deadline-width" class="small-font"
            style="display: inline-block; position: absolute; top: -10000px"></div>
    </div>
    <script type="text/javascript">
        window.I18N_DATA = {
            "app_name": "Second Brain",
            "app_language": "en",
            "cmm_ok": "OK",
            "cmm_cancel": "Cancel",
            "cmm_rmv": "Remove",
            "cmm_del": "Delete",
            "cmm_none": "None",
            "cmm_just_now": "just now",
            "cmm_before_min": "{0} minutes ago",
            "cmm_before_hour": "{0} hours ago",
            "cmm_before_day": "{0} days ago",
            "cmm_sun": "Su",
            "cmm_mon": "Mo",
            "cmm_tue": "Tu",
            "cmm_wed": "We",
            "cmm_thu": "Th",
            "cmm_fri": "Fr",
            "cmm_sat": "Sa",
            "cmm_sun_ddd": "Sun",
            "cmm_mon_ddd": "Mon",
            "cmm_tue_ddd": "Tue",
            "cmm_wed_ddd": "Wed",
            "cmm_thu_ddd": "Thu",
            "cmm_fri_ddd": "Fri",
            "cmm_sat_ddd": "Sat",
            "cmm_today": "Today",
            "cmm_yesterday": "Yesterday",
            "cmm_tomorrow": "Tomorrow",
            "cmm_or": "or",
            "cmm_local_hour": "{0}h",
            "cmm_local_minute": "{0}m",
            "cmm_local_h_m": "{0}h {1}m",
            "usr_username": "Username",
            "usr_pwd": "Password",
            "usr_pwd_placeholder": "6~18 Characters",
            "usr_login": "Sign In",
            "usr_login_space": "Sign In",
            "usr_register": "Sign Up",
            "usr_register_space": "Sign Up",
            "usr_sync": "Sync Now",
            "usr_logout": "Sign Out",
            "usr_logout_prompt": "Are you sure to sign out?",
            "usr_logout_err": "\u26a0\ufe0fData Synchronization Failed",
            "usr_logout_err_prompt": "The unsynchronized data will be lost after sign out. Are you sure you want to sign out?",
            "usr_change_pwd": "Change Password",
            "usr_old_pwd": "Current Password",
            "usr_new_pwd": "New Password",
            "usr_confirm_pwd": "Repeat New Password",
            "usr_acct": "Account",
            "usr_new_acct": "New Account",
            "usr_change_acct": "Change Account",
            "usr_portrait": "Avatar",
            "usr_upload": "Upload",
            "usr_probation": "Premium period remaining: {0} days",
            "usr_purchase": "Upgrade to Premium",
            "usr_set": "Account Settings",
            "usr_sent": "Sent",
            "usr_email": "Email address",
            "usr_forget_pwd": "Forget Password?",
            "usr_register_acct": "Sign Up",
            "usr_return": "Back",
            "usr_reset_pwd": "Reset Password",
            "usr_reset_pwd_prompt": "Enter your email address and we''ll send you instructions for resetting your password.",
            "usr_reset_pwd_success": "Reset password successfully",
            "usr_login_now": "Sign In",
            "usr_login_content1": "Sign in to enjoy more Premium features",
            "usr_login_content2": "Cloud Backup",
            "usr_login_content3": "All-Platform Synchronization",
            "usr_last_sync": "Last synced:\\n",
            "usr_acct_management": "Account Management",
            "usr_acct_del": "Delete Account",
            "usr_acct_del_prompt": "After the account is deleted, the account and all data and premium information in the account will be deleted and cannot be recovered.",
            "usr_data_del": "Delete Data",
            "usr_data_del_prompt": "After deleting data, all data in the account will be deleted and cannot be recovered.",
            "usr_avatar_invalid": "Your avatar may contain inappropriate content",
            "err_pwd_old": "Current password entered is wrong.",
            "err_pwd_diff": "Two passwords entered do not match.",
            "err_pwd_format": "The password must contain 6~18 characters.",
            "err_acct_format": "Please enter a valid email address.",
            "err_acct_not_exist": "The email you entered does not exist.",
            "err_acct_exist": "An account with this email address already exists.",
            "err_pwd": "The password you entered was incorrect.",
            "err_acct_or_pwd": "The email or password you entered was incorrect. Please try again.",
            "err_network_not_available": "Could not connect to the server",
            "prj": "Project",
            "prj_default": "Tasks",
            "prj_myday": "Today''s Tasks",
            "prj_overdue": "Overdue",
            "prj_next7days": "Next 7 Days",
            "prj_all": "All",
            "prj_week": "This Week",
            "prj_today": "Today",
            "prj_tomorrow": "Tomorrow",
            "prj_upcoming": "Planned",
            "prj_someday": "Someday",
            "prj_calendar": "Calendar",
            "prj_history": "Completed",
            "prj_search": "Search",
            "prj_new": "Add Project",
            "prj_new_placeholder": "New project name",
            "prj_rename": "Rename Project",
            "prj_del": "Delete Project",
            "prj_edit": "Edit Project",
            "prj_hide": "Complete",
            "prj_hide_prompt": "After the project is completed, the project will not be displayed in the project list, you can make it as uncompleted in \"Settings -> Projects\".",
            "prj_del_title": "Are you sure you want to delete \"{0}\"?",
            "prj_del_prompt": "After the project is deleted, all data related to that project will disappear and will not be displayed in the report.",
            "prj_del_alert": "Please keep at least one project.",
            "prj_estimate_time": "Estimated Time",
            "prj_unfinished_task": "Tasks to be Completed",
            "prj_spent_time": "Elapsed Time",
            "prj_finished_task": "Completed Tasks",
            "tag": "Tags",
            "tag_new": "New Tag",
            "tag_edit": "Edit Tag",
            "tag_placeholder": "Tag name",
            "tag_del": "Delete",
            "fld_new": "New Folder",
            "fld_edit": "Edit Folder",
            "fld_placeholder": "Folder name",
            "fld_del": "Delete",
            "fld_click_add": "Tap to add projects",
            "tsk_new_placeholder": "Add a task to \"{0}\", press \u300cEnter\u300d to save",
            "tsk_show_finished": "Show Completed Tasks",
            "tsk_hide_finished": "Hide Completed Tasks",
            "tsk_complete": "Mark as Completed",
            "tsk_start": "Start Timing",
            "tsk_pomo": "Pomodoro",
            "tsk_estimated_pomo": "Estimated Pomodoros",
            "tsk_move_to_myday": "Add to \"Today''s Tasks\"",
            "tsk_remove_from_myday": "Remove from \"Today''s Tasks\"",
            "tsk_deadline_today": "Due Today",
            "tsk_deadline_tomorrow": "Due Tomorrow",
            "tsk_deadline_custom": "Set due date",
            "tsk_move_prj": "Move to Project",
            "tsk_del": "Delete Task",
            "tsk_del_title": "Are you sure you want to delete \"{0}\"?",
            "tsk_del_prompt": "Task data will disappear and can not be recovered.",
            "tsk_del_repeat_prompt": "After deleting the current task, the current task will be deleted and the next task will be generated\uff1bAfter deleting all the following tasks, the task will be deleted and no new task will be generated.",
            "tsk_del_current": "Delete The Current Task",
            "tsk_del_repeat": "Delete All The Following Tasks",
            "tsk_uncomplete": "Mark as Uncompleted",
            "tsk_deadline": "Due Date",
            "tsk_reminder": "Reminder",
            "tsk_repeat": "Repeat",
            "tsk_every": "every",
            "tsk_days": "days",
            "tsk_weeks": "weeks",
            "tsk_months": "months",
            "tsk_years": "years",
            "tsk_every_day": "Every Day",
            "tsk_every_week": "Every Week on {0}",
            "tsk_every_weeks": "Every {1} Weeks on {0}",
            "tsk_weekday_separator": ",",
            "tsk_every_month": "Every Month",
            "tsk_every_year": "Every Year",
            "tsk_subtask_new": "Add a subtask...",
            "tsk_remark": "Add a note...",
            "tsk_creation": "Created on {0}",
            "tsk_fulfill": "Completed on {0}",
            "tsk_notification": "Notifications",
            "tsk_order_project": "Sort by project",
            "tsk_order_priority": "Sort by task priority",
            "tsk_order_deadline": "Sort by due date",
            "tsk_order_customized": "Custom",
            "tsk_priority": "Priority",
            "tsk_priority_none": "No Priority",
            "tsk_priority_low": "Low Priority",
            "tsk_priority_middle": "Medium Priority",
            "tsk_priority_high": "High Priority",
            "tsk_show_more": "Show More",
            "tsk_history_no_record": "No Record",
            "tsk_empty_tip": "Click the input box above to add a new task",
            "tsk_next_date": "Next task: {0}",
            "tsk_search_result": "Search Results",
            "tsk_no_search_result": "No task found",
            "sbt_del": "Delete",
            "sbt_del_msg": "The subtask and the focus time of this subtask will disappear and can not be recovered.",
            "cal_all_day": "All Day",
            "cal_day_scheduled": "Scheduled",
            "cal_day_completed": "Completed",
            "tmr_start": "Start to Focus",
            "tmr_pause": "Pause",
            "tmr_continue": "Continue",
            "tmr_start_break": "Start Break Time",
            "tmr_complete": "Done",
            "tmr_stop": "Stop",
            "tmr_stop_title": "Stop This Pomodoro?",
            "tmr_stop_prompt": "Are you sure to stop timing?",
            "tmr_pomo_title": "Pomodoro has finished.",
            "tmr_pomo_msg": "Pomodoro has finished, let''s take a break!",
            "tmr_count_pomo_title": "\ud83c\udf89You have focused for {0}.",
            "tmr_count_pomo_msg": "Pomodoro has already been completed, and the new Pomodoro has started timing.",
            "tmr_break_title": "Break has ended.",
            "tmr_break_msg": "Break has ended, it''s time to work!",
            "tmr_mode": "Timer Mode",
            "tmr_fullscreen": "Fullscreen",
            "tmr_mode_prompt": "Please set it after the timer ends",
            "tmr_mode_countdown_desc": "Count down from {0} until the end of the time.",
            "tmr_mode_count_desc": "Start counting from 00:00 until stop manually.",
            "tmr_no_task_tip": "Please select a task...",
            "tmr_today_detail": "Today''s Focus Time Records",
            "tmr_edit_widget": "Edit Widgets",
            "tmr_add_widget": "Add Widgets",
            "pomo": "Pomodoro Timer",
            "pomo_len": "Pomodoro Length",
            "pomo_break_short": "Short Break Length",
            "pomo_break_long": "Long Break Length",
            "pomo_min": "{0} Minutes",
            "pomo_break_num": "Long Break After",
            "pomo_unit": "{0} Pomodoros",
            "pomo_auto_start": "Auto Start of Next Pomodoro",
            "pomo_auto_break": "Auto Start of Break",
            "pomo_ban_break": "Disable Break",
            "pomo_estimated_time": "Estimated Pomodoro Time",
            "pomo_num": "Pomodoro",
            "pomo_new": "New Pomodoro Record",
            "pomo_task_title": "Task Name",
            "pomo_start_time": "Start Time",
            "pomo_without_task": "No task specified",
            "pomo_no_task": "No Task",
            "pomo_finished_task": "Completed Tasks",
            "pomo_unfinished_task": "Uncompleted Tasks",
            "pomo_del": "Delete",
            "pomo_del_title": "Are you sure you want to delete this Pomodoro?",
            "pomo_del_msg": "Pomodoro will disappear and can not be recovered.",
            "pur": "Premium",
            "pur_title": "Get Premium",
            "pur_pls_title": "",
            "pur_alert_content": "This is a premium feature.",
            "pur_alert_ok": "Upgrade Now",
            "pur_sync": "Synchronize data within all devices.",
            "pur_sync_tip": "Additional premium on other platforms are required to synchronize data with devices on other platforms.",
            "pur_cloud": "Cloud backup.",
            "pur_report": "Detailed statistics report.",
            "pur_project": "Unlimited  quantity of projects.",
            "pur_tag": "Tags for tasks.",
            "pur_folder": "Folders for projects.",
            "pur_task_pomo": "Set pomodoro length for a task.",
            "pur_history": "Check more historical pomodoro records and completed tasks.",
            "pur_pomo_add": "Add and edit pomodoro records manually.",
            "pur_repeat": "Feature of repeating tasks.",
            "pur_reminder": "Feature of reminding tasks.",
            "pur_pomodoro": "User-defined of Pomodoro Timer.",
            "pur_sound": "More white noise and alarm sounds.",
            "pur_theme": "More Themes.",
            "pur_future": "New features coming soon.",
            "pur_ok": "One-time Payment, Permanent Use",
            "pur_restore": "Restore Purchases",
            "pur_proversion": "You have upgraded to lifetime premium",
            "pur_failed_prompt": "If purchase fails, please contact the developer:",
            "pur_quarterly_title": "3 Months",
            "pur_forever_title": "Lifetime",
            "pur_payment_options_title": "Please select a payment option",
            "pur_success": "Payment Successful!",
            "abt": "About",
            "abt_download": "Download",
            "abt_officalsite": "Official Website",
            "abt_version": "Version",
            "abt_feedback": "Help & Feedback",
            "abt_rate": "Rate Us",
            "abt_rate_now": "Rate Now",
            "abt_rate_title": "Love using {0}?",
            "abt_rate_message": "If you enjoy using {0}, would you mind taking a moment to rate it? It won''t take more than a minute. Thanks for your support!",
            "abt_rate_us": "Rate Us",
            "abt_rate_later": "Later",
            "abt_rate_refuse": "No, thank you",
            "alm": "Alarm Sound",
            "alm_work": "Focus Alarm",
            "alm_break": "Break Alarm",
            "alm_AlarmBeep": "Alarm Beep",
            "alm_Beeps": "Beeps",
            "alm_Bell1": "Bell1",
            "alm_Bell2": "Bell2",
            "alm_BicycleBell": "Bicycle Bell",
            "alm_Birdcall": "Birdcall",
            "alm_CarHorn": "Klaxon",
            "alm_ClownHorn": "Clown Horn",
            "alm_CockCrow": "Cock",
            "alm_Cuckoo": "Cuckoo",
            "alm_DrumCymbalCrash": "Drum Cymbal Crash",
            "alm_Fanfare": "Victory Trumpets",
            "alm_Music1": "Musical1",
            "alm_Music2": "Musical2",
            "alm_Music3": "Musical3",
            "bgm_Mute": "None",
            "alm_None": "None",
            "alm_PartyHorn": "Party Horn",
            "alm_Percussion": "Percussion Instrument",
            "alm_PianoMusic": "Piano Music",
            "alm_RingTone": "Ring Tone",
            "alm_Satellite": "Satellite",
            "alm_SchoolBell": "School Bell",
            "alm_ToyNoisemakerHonk": "Toy Noisemaker Honk",
            "alm_Victory": "Triumph",
            "alm_Whistle": "Whistle",
            "alm_WindChimes": "Wind Chimes",
            "alm_WindUp": "Winding Up a Clock",
            "alm_Timer": "Timer",
            "alm_volume": "Volume",
            "bgm": "White Noise",
            "bgm_Classroom": "Class Room",
            "bgm_CofficeShop": "Cafe",
            "bgm_FastTicking": "Countdown",
            "bgm_FireBurning": "Bonfire",
            "bgm_Library": "Library",
            "bgm_OceanShore": "Ocean Shore",
            "bgm_Rain": "Rain",
            "bgm_Stream": "Stream",
            "bgm_Ticking": "Tic-tac",
            "bgm_Wilderness": "Wilderness",
            "bgm_WindThroughTrees": "Wind",
            "bgm_WindWithCrickets": "Wind With Crickets",
            "bgm_Frogs": "Frogs At Night",
            "bgm_BrownNoise": "Brown Noise",
            "bgm_Metronome": "Metronome",
            "apr": "Appearance",
            "apr_dark_mode": "Dark Mode",
            "apr_light": "Light",
            "apr_dark": "Dark",
            "apr_sys": "Automatic",
            "apr_theme": "Theme",
            "gen_play_complete_sound": "Play task completion sound",
            "gen_new_task_on_top": "Add new tasks on top",
            "gen_feature": "Feature toggles",
            "set": "Settings",
            "rpt": "Report",
            "rpt_pomo_total": "Total Completed Pomodoros",
            "rpt_pomo_week": "Pomodoros Completed This Week",
            "rpt_pomo_today": "Pomodoros Completed Today",
            "rpt_time_total": "Total Focus Time",
            "rpt_time_week": "Focus Time of This Week",
            "rpt_time_today": "Focus Time of Today",
            "rpt_tsk_total": "Total Completed Tasks",
            "rpt_tsk_week": "Tasks Completed This Week",
            "rpt_tsk_today": "Tasks Completed Today",
            "rpt_review": "Pomodoro Records",
            "rpt_project_time": "Project Time Distribution",
            "rpt_daily": "Daily",
            "rpt_weekly": "Weekly",
            "rpt_monthly": "Monthly",
            "rpt_yearly": "Yearly",
            "rpt_no_data": "No Data",
            "rpt_pomo_chart": "Focus Time Chart",
            "rpt_pomo_summary": "Top: {0}\u3000\u3000Average: {1}",
            "rpt_tsk_chart": "Task Chart",
            "rpt_tsk_summary": "Top\uff1a{0} Tasks\u3000\u3000Average\uff1a{1} Tasks",
            "rpt_no_project": "No Project",
            "rpt_other_project": "Others",
            "rpt_focus_time": "Focus Time",
            "rpt_focus_time_desc": "Total focus time: {0}",
            "rpt_focus_time_show_task": "Show Tasks",
            "rpt_focus_time_show_project": "Show Projects",
            "rpt_focus_time_show_tag": "Show Tags",
            "rpt_goal": "Focus Time Goal",
            "rpt_goal_desc": "Focus Days: {0} days\uff0cCompleted Goal Days: {1} days\uff0cGoal Completion Rate: {2}%",
            "rpt_goal_target": "Goal: {0}H",
            "rk": "Focus Time Ranking",
            "rk_30_days": "Last 30 Days",
            "rk_all": "Overall",
            "rk_tip": "Instructions",
            "rk_tips": "1.Manually added focus time is not included in the rankings.\\n2.Excessive focus time within a day will not be included in the rankings.\\n3.Rankings are updated every hour.",
            "frt": "Forest",
            "frt_act": "Activities",
            "frt_login": "Daily login",
            "frt_login_continue": "Login streak: {0} days",
            "frt_task": "Complete a task",
            "frt_pomo": "Complete a pomodoro",
            "frt_act_desc": "{0}g sunlight generated",
            "frt_sun_tip": "{0} hours and {1} minutes still needed to collect the sunlight",
            "frt_time_now": "just now",
            "frt_time_min": "{0} minutes ago",
            "frt_time_hour": "{0} hours ago",
            "frt_time_day": "{0} days ago",
            "frt_guide_title": "Guidance",
            "frt_guide_rule": "Basic Rules",
            "frt_guide_gen_sun": "How to generate sunlight",
            "frt_guide_get_sun": "How to collect sunlight",
            "frt_guide_rule_desc": "Focus on work or study, generate sunlight for small saplings, and grow with the saplings.",
            "frt_guide_gen_sun_desc_1": "\u2600\ufe0f Complete a 25-minute pomodoro to create 25g sunlight",
            "frt_guide_gen_sun_desc_2": "\u2600\ufe0f Complete a task to create 5g sunlight",
            "frt_guide_gen_sun_desc_3": "\u2600\ufe0f Log in for the first time every day generates 30g sunlight",
            "frt_guide_gen_sun_desc_4": "\u2600\ufe0f Log in continuously for N days generates (N x 6)g sunlight, the upper limit of N is 80",
            "frt_guide_get_sun_desc_1": "Sunlight is being generated and can only be collected after 24 hours",
            "frt_guide_get_sun_desc_2": "Sunlight can be collected, or will disappear within 24 hours",
            "frt_sun_tip_max": "You can only collect up to 800g of sunlight per day",
            "frt_ranking": "Ranking",
            "grp_title": "Group",
            "grp_new_group_title": "Create New Group",
            "grp_new_group_name": "Group Name",
            "grp_new_group_description": "Profile",
            "grp_my_groups": "My Groups",
            "grp_more_groups": "More Groups",
            "grp_refresh": "Refresh",
            "grp_search": "Search",
            "grp_create": "Create",
            "grp_my_group_none_tip": "Haven''t joined any groups yet",
            "grp_add_group_title": "Join Group",
            "grp_add_group_hint": "Enter the group code",
            "grp_add_group_max_group_tip": "Can only join up to 3 groups",
            "grp_add_group_not_exist_tip": "This group does not exist",
            "grp_add_group_max_user_tip": "The group is full",
            "grp_detail_join": "Join",
            "grp_exit": "Leave",
            "grp_edit": "Edit Group",
            "grp_total_focus_time": "Total Focus Time: {0}h",
            "grp_members_count": "Members: {0}",
            "grp_members": "Members",
            "grp_messages": "Messages",
            "grp_detail_week": "This Week:",
            "grp_detail_day": "Today:",
            "grp_detail_write_message": "Write a message...",
            "grp_detail_reply_message": "Reply:",
            "grp_edit_last_updated": "Last updated: {0}",
            "grp_edit_remove": "Remove",
            "grp_edit_remove_title": "Are you sure you want to remove this user?",
            "grp_quit_title": "Are you sure you want to leave the group?",
            "grp_detail_focusing": "Focusing...",
            "grp_private": "Private",
            "grp_select_group": "Please select a group",
            "grp_code": "Group Code",
            "grp_create_failed": "Failed to create group",
            "grp_detail_select_group": "Please select a group",
            "grp_msg_empty": "No messages yet",
            "grp_edit_user_mgt": "Member Management",
            "grp_save_changes": "Save",
            "grp_copied": "Copied",
            "grp_quit_group": "Quit Group",
            "grp_remove_user_title": "Remove Member",
            "date_md": "D MMM",
            "date_mdw": "ddd, D MMM",
            "date_ymdw": "ddd, D MMM YYYY",
            "date_ym": "MMM YYYY",
            "date_ymd": "D MMM YYYY",
            "date_ymdt": "D MMM YYYY h:mm a",
            "date_hm": "h:mm a",
            "upg_title": "New version",
            "upg_msg": "For a better experience, please update to the latest version!",
            "upg_msg_must": "For a better experience, please update to the latest version!",
            "upg_upgradenow": "Update Now",
            "gen": "General",
            "gen_project_management": "Projects",
            "db_upgrading": "Updating...",
            "db_downloading": "Downloading...",
        };
    </script>
    <script type="text/javascript" src="js/fix_i18n.js"></script>

    <script type="text/javascript" src="js/i18n.js"></script>
    <script type="text/javascript" src="js/chrome-polyfill.js"></script>
    <script src="js/blank-page-preventer.js"></script>
    <script src="js/force-reset.js"></script>
    <script src="js/data-sanitizer.js"></script>
    <!-- ✅ CRITICAL: Mock Encryption to allow Render -->
    <script src="js/crypto-stub.js"></script>
    <script src="js/suppress-errors.js?v=1000"></script>
    <script src="js/websocket-mock.js?v=1000"></script> <!-- ✅ Added WebSocket Mock -->
    <script src="js/notifications.js"></script>
    <script src="js/login-interceptor.js"></script>
    <script src="js/fix-json-only.js?v=2000"></script>
    <script src="js/cookie-protector.js?v=3000"></script>
    <script src="js/cookie-injector.js?v=2001"></script>
    <script src="js/cookie-patcher.js?v=3002"></script>
    <script src="js/main-patcher.js?v=2003"></script>
    <script src="js/config.js"></script>
    <script src="js/system-projects.js?v=1003"></script> <!-- Definitions needed by SessionManager -->
    <script type="text/javascript" src="js/auth-fetch.js?v=1003"></script>
    <script type="text/javascript" src="js/sync-service.js?v=1002"></script>

    <!-- ═══════════════════════════════════════════════════════════════════ -->
    <!-- ✅ CRITICAL: HYDRATION INTEGRITY LAYER - MUST LOAD BEFORE session-manager -->
    <!-- These scripts ensure IndexedDB operations are properly scoped to user -->
    <!-- ═══════════════════════════════════════════════════════════════════ -->
    <script src="js/db-recovery.js?v=1000"></script> <!-- Recovery tool: run window.resetDB() in console -->
    <script src="js/user-db.js?v=1002"></script> <!-- User-scoped database helper - MUST load FIRST -->
    <script src="js/indexeddb-open-interceptor.js?v=1002"></script> <!-- Redirect main.js DB opens to user-scoped DB -->
    <script src="js/indexeddb-guardian.js?v=1002"></script>
    <script src="js/guardian-loader.js?v=1000"></script>

    <!-- ✅ CRITICAL: Write protector MUST load BEFORE main.js -->
    <script src="js/indexeddb-write-protector.js?v=1000"></script>

    <!-- ✅ CRITICAL: Hydration mutex MUST load BEFORE session-manager to prevent race condition -->
    <script src="js/hydration-mutex.js?v=1007"></script> <!-- Hydration state machine -->
    <script src="js/hydration-gate.js?v=1002"></script>

    <!-- ✅ CRITICAL: Username poison blocker MUST load BEFORE session-manager -->

    <!-- ✅ NOW session-manager can safely check mutex state -->
    <script src="js/session-manager.js?v=1011"></script>
    <script src="js/settings-fixer.js?v=1005"></script>


    <!-- ✅ UI Cleanup: Hide unwanted features -->
    <script src="js/ui-cleanup.js?v=1000"></script>

    <!-- ✅ Profile Image Fix: Replace undefined avatar with default -->
    <script src="js/profile-image-fix.js?v=1000"></script>

    <!-- Hydration gate - validates session and ensures data ready -->

    <!-- Hydration Gate: Wait for data before loading main.js -->
    <!-- Hydration Gate: Wait for data before loading main.js -->
    <script>
        (async () => {
            console.log('[Loader] Waiting for hydration...');
            const result = await window.__HYDRATION_COMPLETE__;

            console.log('[Loader] Hydration result:', result);

            if (result.ready) {
                console.log('[Loader] ✅ Data ready - loading main.js');
                
                // SHOW LOADER before loading main.js
                const loader = document.getElementById('app-loader');
                if (loader) {
                    loader.style.display = 'flex';
                    loader.style.opacity = '1';
                    console.log('[Loader] 🎨 Showing loader for main.js loading...');
                }
                
                const script = document.createElement('script');
                script.type = 'text/javascript';
                script.src = 'js/main.js';
                document.body.appendChild(script);
            } else {
                console.log('[Loader] ❌ Not ready:', result.reason);
                // Load main.js anyway for login screen (unless critical error)
                if (result.reason === 'no-auth' || result.reason === 'invalid-session') {
                    console.log('[Loader] Loading main.js for login screen');
                    const script = document.createElement('script');
                    script.type = 'text/javascript';
                    script.src = 'js/main.js';
                    document.body.appendChild(script);
                } else {
                    document.body.innerHTML = '<div style="padding: 40px; text-align: center;"><h2>Error</h2><p>' + result.reason + '</p></div>';
                }
            }
        })();
    </script>

    <!-- Diagnostic: Check Redux state -->
    <script src="js/redux-diagnostic.js"></script>

    <script type="text/javascript" src="js/sync-button-handler.js"></script>

</body>

</html>